<div class="kml-import-page-container">
  <div class="container d-none d-md-block">
    <div class="row">
      <div class="col-md-12 pt-5 pb-3">
        <h1 class="mat-display-1 text-center">KML Import</h1>
        <p class="mat-body">
          Here you can upload KML files to transfer spots to PKFR Spot for free.
          Anyone can then see, share and review the uploaded spots.
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <mat-horizontal-stepper
          [linear]="true"
          #stepperHorizontal
          color="accent"
        >
          <mat-step label="Select" [stepControl]="uploadFormGroup">
            <form class="pt-3 px-3" [formGroup]="uploadFormGroup">
              <h3 class="mat-h3">Please select a KML file.</h3>
              <app-upload-media-ui
                (uploadMedia)="onUploadMediaSelect($event)"
                [isMediaUpload]="false"
                [maximumSizeInBytes]="0"
                formControlName="uploadCtrl"
                required
              ></app-upload-media-ui>
              <div class="mt-5">
                <button
                  mat-raised-button
                  color="accent"
                  class="float-right"
                  [disabled]="!kmlUploadFile"
                  (click)="continueToSetup()"
                >
                  Continue to setup
                </button>
              </div>
            </form>
          </mat-step>
          <mat-step [stepControl]="setupFormGroup" label="Setup">
            <form class="px-3" [formGroup]="setupFormGroup">
              <div class="container d-lg-block mt-3">
                <div class="row">
                  <div class="col-md-6">
                    <div class="kmlPreview" *ngIf="kmlSetupInfo">
                      <h2 class="mat-h2">Preview</h2>
                      <div class="px-3">
                        <h3 class="mat-h3">
                          <b>{{ kmlSetupInfo.name }}</b>
                        </h3>
                        <p class="mat-body">
                          {{ kmlSetupInfo.description }}
                        </p>
                        <p class="mat-body">
                          <b>{{ kmlSetupInfo.spotCount }} Spots</b> accross
                          <b>{{ kmlSetupInfo.folders.length }} folders</b>.
                        </p>
                      </div>
                    </div>

                    <h2 class="mat-h2">Import Settings</h2>
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Language</mat-label>
                      <input
                        type="text"
                        matInput
                        formControlName="setupLangCtrl"
                        [matAutocomplete]="auto"
                        required
                      /><mat-autocomplete #auto="matAutocomplete">
                        <mat-option
                          *ngFor="let lang of languages"
                          [value]="lang"
                        >
                          {{ lang }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-icon
                        matSuffix
                        matTooltip="The language of the spot names"
                        >help_outline</mat-icon
                      >
                    </mat-form-field>
                    <mat-checkbox color="accent" [checked]="true">
                      Trim name
                    </mat-checkbox>
                    <mat-icon
                      matSuffix
                      class="helpIcon"
                      matTooltip="Removes whitespaces around all the spot names."
                      >help_outline</mat-icon
                    >
                    <mat-form-field class="w-100" appearance="outline">
                      <mat-label>Name RegEx</mat-label>
                      <input
                        matInput
                        formControlName="setupRegExCtrl"
                        placeholder="/.*\-?\s*(\w)$/gi"
                      />
                      <mat-icon
                        matSuffix
                        matTooltip="A regular expression applied to the name of each Spot. The first capture is used for the name."
                        >help_outline</mat-icon
                      >
                    </mat-form-field>
                  </div>
                  <div class="col-md-6">
                    <h2 class="mat-h2">Folders to import</h2>
                    <span
                      *ngIf="kmlSetupInfo && kmlSetupInfo.folders"
                      class="example-list-section"
                    >
                      <ul class="checkbox-list">
                        <li *ngFor="let folder of kmlSetupInfo.folders">
                          <mat-checkbox
                            *ngIf="folder"
                            color="accent"
                            [checked]="true"
                          >
                            {{ folder.name }} ({{ folder.spotCount }} Spots)
                          </mat-checkbox>
                        </li>
                      </ul>
                    </span>
                    <p
                      *ngIf="!kmlSetupInfo || !kmlSetupInfo.folders"
                      class="mat-body"
                    >
                      No folders in KML file.
                    </p>
                  </div>
                </div>
              </div>

              <div class="mt-3">
                <button mat-raised-button class="float-left" matStepperPrevious>
                  Back
                </button>
                <button
                  mat-raised-button
                  class="float-right"
                  color="accent"
                  matStepperNext
                >
                  Import Spots
                </button>
              </div>
            </form>
          </mat-step>
          <mat-step label="Import">
            <div>
              <button mat-button matStepperPrevious>Back</button>
              <button mat-button matStepperNext>Next</button>
            </div>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Verify</ng-template>
            <div>
              <button mat-button matStepperPrevious>Back</button>
              <button mat-button matStepperNext>Next</button>
            </div>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Save</ng-template>
            <div>
              <button mat-button matStepperPrevious>Back</button>
              <button mat-button matStepperNext>Next</button>
            </div>
          </mat-step>
          <mat-step>
            <ng-template matStepLabel>Done</ng-template>
            <p>You are now done.</p>
            <div>
              <button mat-button matStepperPrevious>Back</button>
              <button mat-button (click)="stepperHorizontal.reset()">
                Reset
              </button>
            </div>
          </mat-step>
        </mat-horizontal-stepper>
      </div>
    </div>
  </div>
  <div class="container-fluid d-md-none">
    <div class="row">
      <div class="col-md-12 px-5 pt-5 text-center">
        <h2 class="mat-h2">Sorry!</h2>
      </div>
      <div class="col-md-12 px-5 text-center">
        <p class="mat-body">
          KML Import is not supported on small devices yet!
        </p>
        <!--
        <mat-vertical-stepper [linear]="true" #stepperVertical class="d-md-none">
          vertical stepper goes here
        </mat-vertical-stepper>
        -->
      </div>
    </div>
  </div>
</div>
